<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: web.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: web.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @module web
 * @description Web related module.
 * @requires module:essence
 * @since 1.0
 */
import {say, getKey} from './essence';
import {lastKeyPair} from './data';

/**
 * @description Turn the current webpage into an in-browser editor
 * @param {code} [content=''] Content to be added to the code of the page
 * @public
 * @since 1.0
 * @function
 */
export let PageEditor = (content='') => location.href = `data:text/html, &lt;html contenteditable>${content}&lt;/html>`;

/**
 * @description Server centre/manager.
 * @public
 * @since 1.0
 * @function
 * @property {Server[]} ServerBase.list List of servers
 * @property {number} ServerBase.size Total size of all the servers
 * @property {function(): Array[][]} ServerBase.getDetails Table of details on each servers
 * @property {function(Server)} ServerBase.add Add a server to the list
 * @property {function(Server)} ServerBase.remove Remove the server from the list
 * @property {function(string)} ServerBase.removeByName Remove the server with the specified name from the list
 */
export let ServerBase = {
  list: [],
  size: 0,
  getDetails() {
    let table = [['Name', 'Author', 'Maximum size']];
    this.list.forEach(server => table.push([server.name, server.author, server.maxSize]));
    return table;
  },
  add(server) {
    server.update();
    this.list.push(server);
    this.size += server.maxSize;
    this.list.push(server);
  },
  remove(server) {
    this.list.remove(server);
    this.size -= server.size;
  },
  removeByName(name) {
    let serverSearch = this.list.filter(server => server.name === name);
    let serverFound = new Promise((resolve, reject) => {
      !serverFound.length ? resolve(serverSearch) : reject(`The server #${name} wasn't found!`);
    });
    serverFound.then(server => {
      this.list.remove(server);
      //noinspection JSAnnotator
      server.delete();
    }).catch(err => say(err, 'error'));
  }
};

/**
 * @description System (a bit like in Java)
 * type {{ready: boolean, in: {recording: boolean, data: Array, record: ((KeyStroke?)), startRecording: (()), stopRecording: (())}, log: ((data)), debug: ((cb, ...args)), out: (()), toString: (()), reset: (())}}
 * @global
 * @since 1.0
 * @property {boolean} Sys.ready Ready to transmit inputted data
 * @property {object} Sys.in Input
 * @property {boolean} Sys.in.recording Recording flag
 * @property {Array} Sys.in.data Keystrokes recorded from the window
 * @property {function(Event)} Sys.in.record Input recorder
 * @property {function()} Sys.in.startRecording Record starter
 * @property {function(): string[]} Sys.in.stopRecording Record stopper
 * @property {function(*)} Sys.log Logger
 * @property {function(Function)} Sys.debug Debugger
 * @property {function(): string} Sys.out Output
 * @property {function(): string} Sys.toString() String representation
 * @property {function()} Sys.rest()c Reset the Sys's internals
 */
export const Sys = {
  ready: false,
  in: {
    recording: false,
    data: [],
    record(keyStroke) {
      let keyPair = getKey(keyStroke);
      if (this.recording) this.data.push(keyPair[0]);
      if (keyPair[1] === 10 || keyPair[1] === 13) this.ready = true;

    },
    startRecording() {
      this.recording = true;
      this.ready = false;
      /**
       * @description Start the keystroke recording
       * @param {*} keyStroke Keystroke
       * @returns {undefined}
       * @since 1.0
       * @func
       * @listens window.onkeypress
       */
      window.onkeypress = (keyStroke) => {
        this.record(keyStroke);
        lastKeyPair = getKey(keyStroke);
      };
    },
    stopRecording() {
      this.recording = false;
      window.onkeypress = null;
      return this.data;
    },
  },
  log(data) {
    console.log(`[System]  ${data}`);
  },
  debug(cb, ...args) {
    this.log(`Debugging: ${cb.name}`);
    console.group();
    console.time('debug');
    cb(...args);
    console.timeEnd('Time');
    console.trace();
    console.groupEnd();
  },
  out() {
    say(this.in.data);
    return this.in.data;
  },
  toString() {
    return '[object System]';
  },
  reset() {
    this.data = [];
    this.ready = false;
    this.recording = false;
  }
};

/**
 * @description Ask something at the user (which needs to be typed in the window and not in the CLI.
 * @param {string} [label='Is there a problem ?'] Label of the prompt
 * @returns {Promise} Promise containing the answer
 */
export let ask = (label='Is there a problem ?') => {
  say(label, 'quest');
  Sys.reset();
  Sys.in.startRecording();
  let hasAnswer = new Promise((resolve, reject) => {
    Sys.ready ? resolve(Sys.in.data.join()) : reject('No answer :@');
  });
  Sys.in.stopRecording();
  return hasAnswer;
};</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-maths.html">maths</a></li></ul><h3>Externals</h3><ul><li><a href="Array_external_Array.html">Array</a></li><li><a href="external-String.html">String</a></li><li><a href="Function_external_Function.html">Function</a></li><li><a href="Number_external_Number.html">Number</a></li><li><a href="Object_external_Object.html">Object</a></li><li><a href="String_external_String.html">String</a></li></ul><h3>Classes</h3><ul><li><a href="Element.html">Element</a></li><li><a href="module-dom.checkBrowser.html">checkBrowser</a></li><li><a href="module-dsa.Coroutine.html">Coroutine</a></li><li><a href="module-dsa-Edge.html">Edge</a></li><li><a href="module-dsa-LinkedList.html">LinkedList</a></li><li><a href="module-dsa-Node.html">Node</a></li><li><a href="module-dsa-Vertex.html">Vertex</a></li><li><a href="module-qtest.InvalidExpressionError.html">InvalidExpressionError</a></li><li><a href="module-qtest.InvalidParamError.html">InvalidParamError</a></li></ul><h3>Global</h3><ul><li><a href="global.html#$e">$e</a></li><li><a href="global.html#$f">$f</a></li><li><a href="global.html#$n">$n</a></li><li><a href="global.html#$t">$t</a></li><li><a href="global.html#asyncTime">asyncTime</a></li><li><a href="global.html#bin2char">bin2char</a></li><li><a href="global.html#BrowserDetect">BrowserDetect</a></li><li><a href="global.html#Buffer">Buffer</a></li><li><a href="global.html#char2bin">char2bin</a></li><li><a href="global.html#char2hex">char2hex</a></li><li><a href="global.html#Copy">Copy</a></li><li><a href="global.html#date2num">date2num</a></li><li><a href="global.html#date2s">date2s</a></li><li><a href="global.html#date2txt">date2txt</a></li><li><a href="global.html#dateDiff">dateDiff</a></li><li><a href="global.html#dateTime">dateTime</a></li><li><a href="global.html#dayOfWeek">dayOfWeek</a></li><li><a href="global.html#displayTime">displayTime</a></li><li><a href="global.html#DocTemplate">DocTemplate</a></li><li><a href="global.html#entries">entries</a></li><li><a href="global.html#exclude">exclude</a></li><li><a href="global.html#exist">exist</a></li><li><a href="global.html#getArrayType">getArrayType</a></li><li><a href="global.html#getCustomType">getCustomType</a></li><li><a href="global.html#getDate">getDate</a></li><li><a href="global.html#getKey">getKey</a></li><li><a href="global.html#getNativeType">getNativeType</a></li><li><a href="global.html#getTime">getTime</a></li><li><a href="global.html#getTimestamp">getTimestamp</a></li><li><a href="global.html#getType">getType</a></li><li><a href="global.html#hex2char">hex2char</a></li><li><a href="global.html#include">include</a></li><li><a href="global.html#includeOnce">includeOnce</a></li><li><a href="global.html#is2dArray">is2dArray</a></li><li><a href="global.html#isCustomType">isCustomType</a></li><li><a href="global.html#isNativeType">isNativeType</a></li><li><a href="global.html#isNon">isNon</a></li><li><a href="global.html#isType">isType</a></li><li><a href="global.html#isTypedArray">isTypedArray</a></li><li><a href="global.html#keys">keys</a></li><li><a href="global.html#keyTable">keyTable</a></li><li><a href="global.html#loadTime">loadTime</a></li><li><a href="global.html#lookfor">lookfor</a></li><li><a href="global.html#num2date">num2date</a></li><li><a href="global.html#s2date">s2date</a></li><li><a href="global.html#say">say</a></li><li><a href="global.html#time">time</a></li><li><a href="global.html#toSameLength">toSameLength</a></li><li><a href="global.html#txt2date">txt2date</a></li><li><a href="global.html#txt2num">txt2num</a></li><li><a href="global.html#UnitTest">UnitTest</a></li><li><a href="global.html#values">values</a></li><li><a href="global.html#wait">wait</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Fri Jan 27 2017 12:34:15 GMT+0000 (GMT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
